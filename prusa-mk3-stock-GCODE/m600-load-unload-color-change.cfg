###
### Intent: Recreate as closely as possible to Prusa's MK3 marlin implementation of this function
### ChatGPT o3 prompt: 
### Given Prusa's open source firmware, can you create a klipper implementation of the same function as closely as possible? Analyze the code snippet that you created and double check that klipper would interpret it correctly.
###

#######################################################################
#  M600 – filament / colour change (park → unload → PAUSE)            #
#######################################################################
[gcode_macro M600]
description: Filament/colour change – Voron-style single macro
# user-adjustables
variable_park_x: 0
variable_park_y: 200
variable_lift: 10
variable_unload_len: 120
# ----- macro -----
gcode:
  {% set X = params.X|default(park_x)|float %}
  {% set Y = params.Y|default(park_y)|float %}
  {% set Z = params.Z|default(lift)|float %}
  {% set U = params.U|default(unload_len)|float %}
  SAVE_GCODE_STATE NAME=FIL_SWAP
  G91
  G1 E-2  F2400            ; quick retract
  G1 Z{Z} F600
  G90
  G1 X{X} Y{Y} F6000
  G91
  G1 E-{U} F1800           ; full unload
  G90
  RESPOND MSG="Insert new filament → press RESUME"
  PAUSE
